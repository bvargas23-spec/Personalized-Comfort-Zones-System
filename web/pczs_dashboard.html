<!-- web/pczs_dashboard.html -->
<!DOCTYPE html>
<html>
<head>
    <title>PCZS - Personalized Comfort Zones System</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f0f8ff;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
        }
        .dashboard {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
        }
        .card {
            width: 48%;
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 5px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .sensors {
            background-color: #e8f5e9;
        }
        .preferences {
            background-color: #e3f2fd;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="range"] {
            width: 100%;
        }
        button {
            background-color: #4caf50;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #388e3c;
        }
        .value-display {
            display: inline-block;
            min-width: 40px;
            text-align: right;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Personalized Comfort Zones System</h1>
        
        <div class="dashboard">
            <div class="card sensors">
                <h2>Current Conditions</h2>
                <p>Temperature: <span id="current-temp">--</span>°C</p>
                <p>Humidity: <span id="current-humidity">--</span>%</p>
                <p>Workspace Status: <span id="workspace-status">--</span></p>
                <p>Fan Status: <span id="fan-status">--</span></p>
            </div>
            
            <div class="card preferences">
                <h2>Your Comfort Preferences</h2>
                <form id="preferences-form">
                    <div class="form-group">
                        <label for="workspace">Workspace:</label>
                        <select id="workspace" name="workspace">
                            <option value="workspace_1">Desk 1</option>
                            <option value="workspace_2">Desk 2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="preferred-temp">Preferred Temperature: <span id="temp-value" class="value-display">23.0</span>°C</label>
                        <input type="range" id="preferred-temp" name="preferred_temp" min="19" max="26" step="0.5" value="23.0">
                    </div>
                    <div class="form-group">
                        <label for="temp-threshold">Temperature Tolerance: ±<span id="threshold-value" class="value-display">1.0</span>°C</label>
                        <input type="range" id="temp-threshold" name="temp_threshold" min="0.5" max="3.0" step="0.5" value="1.0">
                    </div>
                    <div class="form-group">
                        <label for="preferred-humidity">Preferred Humidity: <span id="humidity-value" class="value-display">50</span>%</label>
                        <input type="range" id="preferred-humidity" name="preferred_humidity" min="40" max="60" step="5" value="50">
                    </div>
                    <div class="form-group">
                        <label for="humidity-threshold">Humidity Tolerance: ±<span id="humidity-threshold-value" class="value-display">10</span>%</label>
                        <input type="range" id="humidity-threshold" name="humidity_threshold" min="5" max="15" step="5" value="10">
                    </div>
                    <button type="submit">Save Preferences</button>
                </form>
            </div>
        </div>
    </div>

    <script src="api_gateway.js"></script>
    <script>
        // Update slider value displays
        document.querySelectorAll('input[type="range"]').forEach(function(slider) {
            const valueDisplay = document.getElementById(slider.id + '-value');
            if (valueDisplay) {
                slider.addEventListener('input', function() {
                    valueDisplay.textContent = slider.value;
                });
            }
        });

        // Form submission
        document.getElementById('preferences-form').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            const preferences = {
                user_id: 'user_1', // In a real app, this would come from authentication
                workspace_id: formData.get('workspace'),
                preferred_temp: parseFloat(formData.get('preferred_temp')),
                temp_threshold: parseFloat(formData.get('temp_threshold')),
                preferred_humidity: parseInt(formData.get('preferred_humidity')),
                humidity_threshold: parseInt(formData.get('humidity_threshold'))
            };
            
            savePreferences(preferences);
        });

        // Function to be implemented in api_gateway.js
        function savePreferences(preferences) {
            alert('Preferences API not yet implemented. Data: ' + JSON.stringify(preferences));
            // This will be replaced with actual API call
        }

        // Simulate updating current conditions (this would be replaced with real-time data)
        function simulateUpdates() {
            setInterval(function() {
                const temp = (Math.random() * 5 + 20).toFixed(1);
                const humidity = (Math.random() * 20 + 40).toFixed(1);
                const occupied = Math.random() > 0.3;
                const fanOn = temp > 23 && occupied;
                
                document.getElementById('current-temp').textContent = temp;
                document.getElementById('current-humidity').textContent = humidity;
                document.getElementById('workspace-status').textContent = occupied ? 'Occupied' : 'Unoccupied';
                document.getElementById('fan-status').textContent = fanOn ? 'ON' : 'OFF';
            }, 5000);
        }

        simulateUpdates();
    </script>
</body>
</html>